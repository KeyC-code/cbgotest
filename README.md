Mock CBR Service (–ú–æ–∫-—Å–µ—Ä–≤–∏—Å –¶–ë)
https://img.shields.io/badge/Go-1.25.3-blue
https://img.shields.io/badge/License-MIT-green

–ú–æ–∫-—Å–µ—Ä–≤–∏—Å, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–π API –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –ë–∞–Ω–∫–∞ –†–æ—Å—Å–∏–∏ (XML_daily.asp) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π.

‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
üéØ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–æ–≤ –¶–ë –†–§

üîß –î–≤–∞ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

üìä –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç (USD, EUR, YEN)

‚ö° Swagger-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è API

üß™ –ì–æ—Ç–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

üîÑ –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç

üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
bash
go mod download
–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
bash
make run
–ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é:

bash
go run ./cmd/server
–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 8080.

üìñ API Endpoints
–û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
–ú–µ—Ç–æ–¥	–≠–Ω–¥–ø–æ–∏–Ω—Ç	–û–ø–∏—Å–∞–Ω–∏–µ	–ü–∞—Ä–∞–º–µ—Ç—Ä—ã
GET	/scripts/XML_daily.asp	–û—Å–Ω–æ–≤–Ω–æ–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (—Å–æ–≤–º–µ—Å—Ç–∏–º —Å –¶–ë)	date_req (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
GET	/cbr	–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç	date_req (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–§–æ—Ä–º–∞—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
date_req (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ): –¥–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ DD/MM/YYYY

–ü—Ä–∏–º–µ—Ä: /cbr?date_req=02/03/2002

–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
–û—Ç–≤–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ XML, –∏–¥–µ–Ω—Ç–∏—á–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç—É –¶–ë –†–§:

xml
<ValCurs Date="02.03.2002" name="Foreign Currency Market">
  <Valute ID="R01235">
    <NumCode>840</NumCode>
    <CharCode>USD</CharCode>
    <Nominal>1</Nominal>
    <Name>–î–æ–ª–ª–∞—Ä –°–®–ê</Name>
    <Value>90,0000</Value>
  </Valute>
  <!-- ... –¥—Ä—É–≥–∏–µ –≤–∞–ª—é—Ç—ã -->
</ValCurs>
üìö Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:

text
http://localhost:8080/swagger/
–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:

bash
make swag
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
bash
make test
–ò–ª–∏:

bash
go test ./...
–û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã
–¢–µ—Å—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¶–ë: internal/handler/cbr_handler_test.go

–¢–µ—Å—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞: payment_test.go

–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ñ–æ—Ä–º–∞—Ç–∞ XML:

bash
go test ./internal/handler
–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π:

bash
go test -v -run TestPaymentValidation
–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

bash
go test -v -run TestParallelPayment
üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ
–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
go
import "mock-cbr/internal/storage"

// –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Å –∫—É—Ä—Å–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
rates := storage.NewRates()

// –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ –∫—É—Ä—Å–∞
rates.SetRate("USD", 95.5)
rates.SetRate("EUR", 102.3)

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞
usdRate, err := rates.GetRate("USD")
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
go
import "mock-cbr/internal/service"

// –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
paymentService := service.NewPaymentService(rates)

// –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–∞
request := service.PaymentRequest{
    Provider: "test_provider",
    Amount:   100,
    Currency: "USD",
}

response := paymentService.ProcessPayment(request)

if response.Allowed {
    fmt.Printf("–ü–ª–∞—Ç–µ–∂ —Ä–∞–∑—Ä–µ—à–µ–Ω: %.2f RUB\n", response.Amount)
} else {
    fmt.Printf("–ü–ª–∞—Ç–µ–∂ –æ—Ç–∫–ª–æ–Ω–µ–Ω: %s\n", response.Message)
}
üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
text
mock-cbr/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ       ‚îî‚îÄ‚îÄ main.go          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ handler/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cbr_handler.go   # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤ –¶–ë
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cbr_handler_test.go # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cbr_models.go    # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¶–ë
‚îÇ   ‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ payment.go       # –ü–ª–∞—Ç–µ–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îî‚îÄ‚îÄ storage/
‚îÇ       ‚îî‚îÄ‚îÄ rates.go         # –•—Ä–∞–Ω–∏–ª–∏—â–µ –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ swagger.json         # Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ payment_test.go          # –¢–µ—Å—Ç—ã –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ Makefile                 # –£—Ç–∏–ª–∏—Ç—ã —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ go.mod                   # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                # –≠—Ç–æ—Ç —Ñ–∞–π–ª
üîß –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –≤–∞–ª—é—Ç—ã
–°–µ—Ä–≤–∏—Å –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è 18 –≤–∞–ª—é—Ç:

USD (–î–æ–ª–ª–∞—Ä –°–®–ê)

EUR (–ï–≤—Ä–æ)

GBP (–§—É–Ω—Ç —Å—Ç–µ—Ä–ª–∏–Ω–≥–æ–≤)

JPY (–ò–µ–Ω–∞)

CHF (–®–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π —Ñ—Ä–∞–Ω–∫)

... –∏ –¥—Ä—É–≥–∏–µ (—Å–º. internal/models/cbr_models.go)

–í—ã –º–æ–∂–µ—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –≤–∞–ª—é—Ç—ã —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ SetRate().

‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
–ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞: 8080

–õ–∏–º–∏—Ç –ø–ª–∞—Ç–µ–∂–µ–π: 15000 RUB

–ó–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç–≤–µ—Ç–∞: 50 –º—Å (–∏–º–∏—Ç–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏)

–ö–æ–¥–∏—Ä–æ–≤–∫–∞: UTF-8

–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—Ç–∞ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ cmd/server/main.go:

go
server := &http.Server{
    Addr:    ":9090",  // –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –∑–¥–µ—Å—å
    Handler: mux,
}
